<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Mens et Manus">
<meta property="og:type" content="website">
<meta property="og:title" content="Ring&#39;s Blog">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="Ring&#39;s Blog">
<meta property="og:description" content="Mens et Manus">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Travis TuRing">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Ring's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Ring's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/11/21/universe/web/ajax_intro/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Travis TuRing">
      <meta itemprop="description" content="Mens et Manus">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ring's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/11/21/universe/web/ajax_intro/" class="post-title-link" itemprop="url">JQuery, fetch, axios</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-11-21 00:00:00 / Modified: 22:23:38" itemprop="dateCreated datePublished" datetime="2020-11-21T00:00:00+08:00">2020-11-21</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Ajax简介"><a href="#Ajax简介" class="headerlink" title="Ajax简介"></a>Ajax简介</h2><p>Ajax本质就是用来进行异步的请求提交，那是怎么个异步法？</p>
<ul>
<li>同步<ul>
<li>跳转或新开一个页面</li>
</ul>
</li>
<li>异步<ul>
<li>页面局部变动，异步请求然后更新局部页面，而不更新整个页面</li>
</ul>
</li>
</ul>
<p>早期进行异步请求是通过XMLHttpRequest(xhr)，但是这种方法代码非常长，冗余严重。后来JQuery出现<code>$.ajax</code>，对xhr进行封装，又有了后来的fetch和axios。</p>
<h2 id="JQuery"><a href="#JQuery" class="headerlink" title="JQuery"></a>JQuery</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 基本请求</span></span><br><span class="line">$.ajax(&#123;</span><br><span class="line">    method: <span class="string">""</span>,</span><br><span class="line">    headers: &#123;<span class="string">"key"</span>: <span class="string">"value"</span>&#125;,</span><br><span class="line">    data: &#123;&#125;,</span><br><span class="line">    url: <span class="string">""</span>,</span><br><span class="line">    success: funciotn()&#123;&#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 也可简写方法</span></span><br><span class="line">$.<span class="keyword">get</span>(url, data, callback)</span><br><span class="line">$.post(url, data, callback)</span><br></pre></td></tr></table></figure>

<p><em>PS</em> :默认使用表单形式提交，需要提交json数据数据时，在headers中设置<code>content-type:application/json</code>，然后data中传入<strong>json字符串</strong></p>
<h2 id="fetch"><a href="#fetch" class="headerlink" title="fetch"></a>fetch</h2><p>现代的浏览器中一般都会自带fetch方法，不需要下载任何js包</p>
<ul>
<li>基本用法：<code>fetch(&quot;usl&quot;, {&lt;args&gt;})</code><ul>
<li>返回一个promise对象</li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fetch(<span class="string">"url"</span>, &#123;</span><br><span class="line">    method: <span class="string">""</span>,</span><br><span class="line">    headers: &#123;&#125;,</span><br><span class="line">    body: <span class="string">""</span>,</span><br><span class="line">&#125;).then(<span class="function"><span class="params">res</span>=&gt;</span>&#123;&#125;).then(<span class="function"><span class="params">res</span>=&gt;</span>&#123;&#125;)</span><br></pre></td></tr></table></figure>


<h2 id="axios"><a href="#axios" class="headerlink" title="axios"></a>axios</h2><p>不单单可以在前端使用，还可以通过nodejs在后端使用</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">axios(&#123;</span><br><span class="line">    url: <span class="string">""</span>,</span><br><span class="line">    method: <span class="string">""</span>,</span><br><span class="line">    headers: &#123;&#125;,</span><br><span class="line">    data: &#123;&#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p>同fetch一样返回promise对象，可以通过<code>then()</code>进一步处理</p>
<p><em>PS</em> :默认使用json形式提交，需要表单提交数据数据时，在headers中设置form的header，如<code>content-type:application/x-www-form-urlencoded</code>，然后data中传入这种形式(查询字符串)的数据<code>&quot;a=123&amp;b=321&quot;</code></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/11/15/universe/c/how_cpp_overload/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Travis TuRing">
      <meta itemprop="description" content="Mens et Manus">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ring's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/11/15/universe/c/how_cpp_overload/" class="post-title-link" itemprop="url">重载是如何实现的</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-11-15 00:00:00 / Modified: 15:04:40" itemprop="dateCreated datePublished" datetime="2020-11-15T00:00:00+08:00">2020-11-15</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>overload可直译为重载，它是指我们可以定义一些名称相同的方法，通过定义不同的输入参数来区分这些方法，然后再调用时就会根据不同的参数样式，来选择合适的方法执行。</p>
<p>–百度百科</p>
</blockquote>
<h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>重载本质上就是编译器根据原函数名和参数类型对原函数名进行改编，以区分接受不同参数的同名函数。</p>
<p>看下面一段cpp代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// a.cpp</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span> a)</span></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    func(<span class="number">1</span>);</span><br><span class="line">    func(<span class="number">1</span>, <span class="number">2</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>规定是不能定义两个同名函数的，但是如果是不同参数的同名函数就可以，这就是重载的作用。</p>
<p>我们通过<code>objdump</code>查看反汇编查看源码来理解其中的原理。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gcc -c a.cpp -o a.o</span><br><span class="line">objump -d a.o</span><br></pre></td></tr></table></figure>

<ul>
<li><code>gcc -c a.cpp -o a.o</code><ul>
<li>这条命令用来汇编生成的目标文件<code>.o</code>结尾</li>
</ul>
</li>
<li><code>objdump -d a.o</code><ul>
<li><code>-d</code>反汇编我们刚才生成目标文件</li>
</ul>
</li>
</ul>
<p>反汇编后将会看到汇编代码，我们抓取我们的重点：接受不同参数的同名函数</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">0000000000000000 &lt;_Z4funci&gt;:</span><br><span class="line">   0:   55                      push   %rbp</span><br><span class="line">   1:   48 89 e5                mov    %rsp,%rbp</span><br><span class="line">   4:   89 7d fc                mov    %edi,-0x4(%rbp)</span><br><span class="line">   7:   90                      nop</span><br><span class="line">   8:   5d                      pop    %rbp</span><br><span class="line">   9:   c3                      retq</span><br><span class="line"></span><br><span class="line">000000000000000a &lt;_Z4funcii&gt;:</span><br><span class="line">   a:   55                      push   %rbp</span><br><span class="line">   b:   48 89 e5                mov    %rsp,%rbp</span><br><span class="line">   e:   89 7d fc                mov    %edi,-0x4(%rbp)</span><br><span class="line">  11:   89 75 f8                mov    %esi,-0x8(%rbp)</span><br><span class="line">  14:   90                      nop</span><br><span class="line">  15:   5d                      pop    %rbp</span><br><span class="line">  16:   c3                      retq</span><br></pre></td></tr></table></figure>

<p>上面看到我们定义的两个同名函数<code>&lt;_Z4funci&gt;</code>和<code>&lt;_Z4funcii&gt;</code>，仔细一看好似有规律可寻。</p>
<ul>
<li><code>_Z</code>后跟的数字表示函数名的长度和函数名，这里是4对应后面<code>func</code>的长度</li>
<li>在函数名的后面跟的就是参数的类型，这里我们分别是一个整形，和两个整形的函数所以就是<code>i</code>和<code>ii</code></li>
</ul>
<p>所以编译器通过这么一个简单的对函数名的改编(name mangling)就可以做到区分接受不同参数的同名函数的功能。</p>
<p><strong>tips:</strong> 使用<code>c++filt</code>可以查看原函数名。</p>
<p>看这么一个函数<code>void func(s string){}</code>，反汇编后的函数名为<code>&lt;_Z4funcNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE&gt;</code>。</p>
<p>使用<code>c++filt</code>查看其原函数名：<code>c++filt _Z4funcNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE</code>。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> c++filt _Z4funcNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEEE </span></span><br><span class="line">func(std::__cxx11::basic_string&lt;char, std::char_traits&lt;char&gt;, std::allocator&lt;char&gt; &gt;)</span><br></pre></td></tr></table></figure>




      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/11/15/universe/linux/cron/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Travis TuRing">
      <meta itemprop="description" content="Mens et Manus">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ring's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/11/15/universe/linux/cron/" class="post-title-link" itemprop="url">cron程序</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-11-15 00:00:00 / Modified: 20:54:02" itemprop="dateCreated datePublished" datetime="2020-11-15T00:00:00+08:00">2020-11-15</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="cron表达式"><a href="#cron表达式" class="headerlink" title="cron表达式"></a>cron表达式</h2><p>cron程序有如下五个字段：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">分  时  日  月  星期    [年]</span><br><span class="line">* * * * *  &lt;shell script&gt;</span><br></pre></td></tr></table></figure>

<p>语法如下</p>
<ul>
<li><code>*</code>，表示<strong>每一</strong><ul>
<li><code>* 1 * 3 *</code>表示每年三月每天1点的每一分钟执行</li>
</ul>
</li>
<li><code>,</code>，表示并列<ul>
<li><code>1,3</code>表示1和3都执行</li>
</ul>
</li>
<li><code>-</code>，表示连续<ul>
<li><code>1-5</code>表示1-5这个区间执行</li>
</ul>
</li>
<li><code>/</code>，表示整除时执行<ul>
<li><code>*/2</code>表示<code>0 2 4...</code>时执行</li>
<li><code>n/2</code>左边有数字的情况，表示减去该数字后被整除时执行</li>
</ul>
</li>
<li>简写<ul>
<li>为提高可读性，有的cron程序支持简写，如Wed表示星期三，Jul表示七月</li>
<li>W表示工作日</li>
<li>L表示最后一天</li>
</ul>
</li>
<li>每秒<ul>
<li>cron程序的字段中并没有提供秒，但是我们可以通过sleep来进行模拟</li>
<li><code>* * * * * sleep n-1 echo &quot;hello&quot; &gt; &lt;FIlE&gt;</code>，这么的第一个sleep 0秒，第n个sleep n-1秒就可以模拟每秒执行的效果</li>
</ul>
</li>
</ul>
<h2 id="Linux环境使用"><a href="#Linux环境使用" class="headerlink" title="Linux环境使用"></a>Linux环境使用</h2><p>详见帮助文档</p>
<ul>
<li><code>crontab</code><ul>
<li><code>-e</code>，编辑cron程序</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/11/15/universe/linux/curl/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Travis TuRing">
      <meta itemprop="description" content="Mens et Manus">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ring's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/11/15/universe/linux/curl/" class="post-title-link" itemprop="url">curl基本使用</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-11-15 00:00:00 / Modified: 21:12:24" itemprop="dateCreated datePublished" datetime="2020-11-15T00:00:00+08:00">2020-11-15</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>等读完curl(如果有时间)，就改成curl all in one</p>
<p>curl是一个http<strong>请求</strong>工具</p>
<ul>
<li><code>curl [options...] &lt;url&gt;</code><ul>
<li><code>queryString</code></li>
<li><code>-s | --silent</code>，不显示进度条</li>
<li><code>-o | --output</code>，指定请求结果输出到的文件</li>
<li><code>-H | --header</code>，设置请求头</li>
<li><code>-d | --data</code>，设置请求携带的数据</li>
<li><code>-X | --request</code>，设置请求使用的方法</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/11/11/universe/tech_tips/a_basic_middleware/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Travis TuRing">
      <meta itemprop="description" content="Mens et Manus">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ring's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/11/11/universe/tech_tips/a_basic_middleware/" class="post-title-link" itemprop="url">制作一个简易的中间件架构</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-11-11 00:00:00" itemprop="dateCreated datePublished" datetime="2020-11-11T00:00:00+08:00">2020-11-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-11-12 22:25:36" itemprop="dateModified" datetime="2020-11-12T22:25:36+08:00">2020-11-12</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="为何需要中间件"><a href="#为何需要中间件" class="headerlink" title="为何需要中间件"></a>为何需要中间件</h2><p>我们不应该把业务逻辑和非业务逻辑揉在一起。非业务逻辑如打印日志、计时等。因为如果我们需要一个新的日志系统，而我们打印日志的逻辑杂揉在每个handler中，那我们就得修改每个handler，费时费力且不明智。</p>
<p>中间件就是一种剥离非业务逻辑的方法。</p>
<h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>我们可以使用函数闭包来轻松实现剥离业务逻辑和非业务逻辑。</p>
<p>假设我们的业务就是以各种姿势处理字符串然后打印。如处理成<code>===str===</code>然后打印。</p>
<p>然后现在我们有个业务逻辑之外的要求，那就是打印完成后在结尾打印<code>done</code>。我们可以简单想到下面业务逻辑和非业务逻辑杂糅的代码。</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">helloHandler</span><span class="params">(s <span class="keyword">string</span>)</span></span>&#123;</span><br><span class="line">    <span class="comment">// 处理业务逻辑</span></span><br><span class="line">    fmt.Println(<span class="string">"==="</span>+str+<span class="string">"==="</span>)</span><br><span class="line">    <span class="comment">// 处理非业务逻辑</span></span><br><span class="line">    fmt.Println(<span class="string">"done"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当然这个处理的逻辑还是比较简单的。如果我们有100个handler以不同姿势打印字符串，如<code>&quot;str&quot;</code>, <code>~str~</code>等，但是现在我们不说done了，要说ok。那我们就得为100个handler修改非业务逻辑的代码。单单这么一个简单的逻辑修改起来就挺费劲了。</p>
<p>那么我们现在用一种优雅的方式来分离业务逻辑和非业务逻辑， <strong>函数闭包</strong> </p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> HandleFunc <span class="function"><span class="keyword">func</span><span class="params">(s <span class="keyword">string</span>)</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">endPoint</span><span class="params">(h HandleFunc)</span> <span class="title">HandleFunc</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(s <span class="keyword">string</span>)</span></span>&#123;</span><br><span class="line">        h(s)</span><br><span class="line">        fmt.Println(<span class="string">"done"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">business</span><span class="params">(s <span class="keyword">string</span>)</span></span>&#123;</span><br><span class="line">    fmt.Println(<span class="string">"==="</span>+s+<span class="string">"==="</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    f := endPoint(business)</span><br><span class="line">    f(<span class="string">"str"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们成功将业务逻辑和非业务逻辑分离，当需要修改非业务逻辑时只需要专注修改非业务逻辑部分(<code>endPoint</code>)，而不需要对每个handler进行修改。</p>
<p>我们的中间件就是通过包装handler(进行些处理)，再返回一个handler，实际上就是不断地进行函数的压栈出栈。</p>
<p><strong>中间件吃什么吐什么</strong>对用户是透明的</p>
<h2 id="优雅的中间件写法"><a href="#优雅的中间件写法" class="headerlink" title="优雅的中间件写法"></a>优雅的中间件写法</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> HandleFunc <span class="function"><span class="keyword">func</span><span class="params">(s <span class="keyword">string</span>)</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 中间件就是一个吃什么吐什么的函数</span></span><br><span class="line"><span class="keyword">type</span> middleware <span class="function"><span class="keyword">func</span><span class="params">(HandleFunc)</span> <span class="title">HandleFunc</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Router <span class="keyword">struct</span> &#123;</span><br><span class="line">	middlewareChain []middleware</span><br><span class="line">	route           <span class="keyword">map</span>[<span class="keyword">string</span>]HandleFunc</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">New</span><span class="params">()</span> *<span class="title">Router</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> &amp;Router&#123;</span><br><span class="line">		route: <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]HandleFunc),</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r *Router)</span> <span class="title">Use</span><span class="params">(m middleware)</span></span> &#123;</span><br><span class="line">	r.middlewareChain = <span class="built_in">append</span>(r.middlewareChain, m)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r *Router)</span> <span class="title">Add</span><span class="params">(route <span class="keyword">string</span>, h HandleFunc)</span></span> &#123;</span><br><span class="line">    mergedHandler := h</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(r.middlewareChain) != <span class="number">0</span> &#123;</span><br><span class="line">		<span class="keyword">for</span> i := <span class="built_in">len</span>(r.middlewareChain) - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i-- &#123;</span><br><span class="line">			mergedHandler = r.middlewareChain[i](mergedHandler)</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	r.route[route] = mergedHandler</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">cors</span><span class="params">(h HandleFunc)</span> <span class="title">HandleFunc</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(s <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"set cors"</span>)</span><br><span class="line">		h(s)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">logger</span><span class="params">(h HandleFunc)</span> <span class="title">HandleFunc</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="function"><span class="keyword">func</span><span class="params">(s <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">"set logger"</span>)</span><br><span class="line">		h(s)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这样一来我们就可以通过<code>Use</code>来直观地增删中间件，并为对应的route设置handler了</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">r := New()</span><br><span class="line">r.Use(logger)</span><br><span class="line">r.Use(cors)</span><br><span class="line">r.Add(<span class="string">"route1"</span>, <span class="function"><span class="keyword">func</span><span class="params">(s <span class="keyword">string</span>)</span></span>&#123;</span><br><span class="line">    fmt.Println(s)</span><br><span class="line">&#125;)</span><br><span class="line">r.route[<span class="string">"route1"</span>](<span class="string">"business 1"</span>)</span><br></pre></td></tr></table></figure>

<p>需要注意的是代码中<code>middlewareChain</code>的遍历顺序和<code>Use</code>的顺序相反，因为调用过程是<code>logger(cors(HanderFunc(s)))</code>，故从内到外包装</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/10/20/Major/OS/Computer_System_A_Programmer's_Perspective/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Travis TuRing">
      <meta itemprop="description" content="Mens et Manus">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ring's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/10/20/Major/OS/Computer_System_A_Programmer's_Perspective/" class="post-title-link" itemprop="url">深入理解计算机系统脑图</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-10-20 00:00:00" itemprop="dateCreated datePublished" datetime="2020-10-20T00:00:00+08:00">2020-10-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-26 22:56:18" itemprop="dateModified" datetime="2020-10-26T22:56:18+08:00">2020-10-26</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="PART1-计算机系统漫游"><a href="#PART1-计算机系统漫游" class="headerlink" title="PART1: 计算机系统漫游"></a>PART1: 计算机系统漫游</h2><ul>
<li>组成设备</li>
</ul>
<h2 id="PART3-程序的机器级表示"><a href="#PART3-程序的机器级表示" class="headerlink" title="PART3: 程序的机器级表示"></a>PART3: 程序的机器级表示</h2><ul>
<li>一个可执行程序<ul>
<li>编译过程<ul>
<li>预处理</li>
<li>编译</li>
<li>汇编</li>
<li>连接</li>
</ul>
</li>
<li>编译细节<ul>
<li><code>gcc -O[g|1|2] &lt;file&gt;</code>优化等级</li>
<li>编译器优化可能会调整代码次序，源代码会严重变形，导致并发时不满足顺序一致性内存模型</li>
</ul>
</li>
</ul>
</li>
<li>数据格式<ul>
<li>字节，字，双字，四字</li>
<li>数据类型的汇编代码表示<ul>
<li>b, w, l, q </li>
</ul>
</li>
</ul>
</li>
<li>操作数指示符<ul>
<li>操作数可以是立即数值、寄存器值和来自内存的值</li>
<li>立即数的形式<code>$Imm</code></li>
<li>寄存器的形式<code>%r</code></li>
<li>内存寻址的形式<code>Imm(rb, ri, si)</code><ul>
<li>表示<code>M[Imm + R[rb] + R[ri]*si</code>，参数是可以省略的，如<code>(,%rcx,)</code></li>
<li><code>M[]</code>表示取内存值，<code>R[]</code>表示取寄存器值</li>
</ul>
</li>
</ul>
</li>
<li>数据传送指令<ul>
<li><code>mov[数据大小]</code></li>
</ul>
</li>
<li>几类寄存器的格式<ul>
<li><code>r[a|b|c|d]x</code>、<code>eax</code>、<code>ax</code>、<code>al</code></li>
<li><code>r[s|d]i</code>、<code>esi</code>、<code>si</code>、<code>sil</code></li>
<li><code>r[b|s]p</code>、<code>esp</code>、<code>sp</code>、<code>spl</code></li>
<li><code>r[8-9]</code>、<code>r8d</code>、<code>r8w</code>、<code>r8b</code></li>
<li>简记：有r说明4字、e说明双字、l说明字节，剩下的就说明是单字</li>
</ul>
</li>
<li>lea(load effective address)取有效地址<ul>
<li><code>leaq 7(%rdi, %rsi, 4), %rax</code>，则<code>%rad=7+R[%rdi]+R[%rsi]*4</code></li>
<li>处理用在取地址，还可以用在简单的加法和乘法</li>
</ul>
</li>
</ul>
<h3 id="栈"><a href="#栈" class="headerlink" title="栈"></a>栈</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">低地址：</span><br><span class="line">    栈顶：%rsp-&gt; |   |</span><br><span class="line">                |   |</span><br><span class="line">                .....</span><br><span class="line">    栈底        |   |</span><br><span class="line">高地址</span><br></pre></td></tr></table></figure>

<ul>
<li><code>pushq S</code>(4字)<ul>
<li><code>R[%rsp] &lt;- R[%rsp]-8</code>，栈顶指针减8<ul>
<li>相当于<code>subq $8, %rsp</code></li>
</ul>
</li>
<li><code>M[R[%rsp]] &lt;- S</code>，入栈<ul>
<li>相当于<code>movq %rbp, (%rsp)</code></li>
</ul>
</li>
<li>区别在于<code>pushq</code>指令编码为1字节</li>
</ul>
</li>
<li>弹出同理<ul>
<li>出栈</li>
<li>指针加</li>
</ul>
</li>
<li>知道了栈内存的分布，则可用内存寻址访问栈<ul>
<li><code>movq 8(%rsp), %rdx</code>，把栈第二个元素存到rdx寄存器中</li>
</ul>
</li>
</ul>
<h3 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h3><ul>
<li>算数运算符<ul>
<li>常见的算数运算符有加减乘除，与或非异或，算数(<code>sa[l|r]</code>)逻辑(<code>sh[l|r]</code>)左右移等<ul>
<li>这些运算符都会改变条件码，以实现条件控制</li>
</ul>
</li>
<li>特殊的算数操作</li>
</ul>
</li>
<li>条件码<ul>
<li>常用条件码有：<ul>
<li>CF：进位标志</li>
<li>ZF：零标志</li>
<li>SF：符号标志</li>
</ul>
</li>
<li>不改变条件码的操作<ul>
<li><code>cmp[b|w|l|q]</code>，与sub相同，只是不改变条件码</li>
<li><code>test[b|w|l|q]</code>，与and相同，只是不改变条件码</li>
</ul>
</li>
<li>访问条件码<ul>
<li>根据条件码设置寄存器01，称为set操作，后缀指明 <strong>考虑的条件码组合</strong> ，如<code>setl R</code>(set less)将D设为<code>SF^OF</code></li>
</ul>
</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/10/06/universe/lua/lua_stl/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Travis TuRing">
      <meta itemprop="description" content="Mens et Manus">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ring's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/10/06/universe/lua/lua_stl/" class="post-title-link" itemprop="url">Lua标准库工具</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-10-06 00:00:00" itemprop="dateCreated datePublished" datetime="2020-10-06T00:00:00+08:00">2020-10-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-11-05 12:04:31" itemprop="dateModified" datetime="2020-11-05T12:04:31+08:00">2020-11-05</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="string"><a href="#string" class="headerlink" title="string"></a>string</h2><ul>
<li><code>string.gmatch(s, pattern)</code><ul>
<li>返回一个迭代器函数，每次调用这个函数，返回一个在字符串<code>s</code>找到的下一个pattern描述的子串。没找到返回<code>nil</code></li>
<li>类型类似正则表达式(或者就是)<ul>
<li><code>%a</code>查找一个字母</li>
<li><code>%w</code>查找一个数字或字母</li>
<li><code>%d</code>查找一个数字</li>
<li><code>(%w+)=(%w+)</code>，<code>()</code>分组，返回成对的，<code>+</code>找一个及以上</li>
</ul>
</li>
</ul>
</li>
<li><code>string.find(str, substr, [init, [end]])</code><ul>
<li>从字符串中搜索子串，返回位置索引，不存在返回nil</li>
</ul>
</li>
<li><code>string.gsub(mainString,findString,replaceString,num)</code><ul>
<li>替换，执行num次</li>
</ul>
</li>
</ul>
<h2 id="table"><a href="#table" class="headerlink" title="table"></a>table</h2>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/10/05/universe/database/sql_base_usage/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Travis TuRing">
      <meta itemprop="description" content="Mens et Manus">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ring's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/10/05/universe/database/sql_base_usage/" class="post-title-link" itemprop="url">SQL基本语句</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-10-05 00:00:00" itemprop="dateCreated datePublished" datetime="2020-10-05T00:00:00+08:00">2020-10-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-11-06 21:33:25" itemprop="dateModified" datetime="2020-11-06T21:33:25+08:00">2020-11-06</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="建表"><a href="#建表" class="headerlink" title="建表"></a>建表</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`tbl_file`</span>(</span><br><span class="line">    <span class="string">`id`</span> <span class="built_in">INT</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">    PRIMARY <span class="keyword">KEY</span>(<span class="string">`id`</span>),</span><br><span class="line">    <span class="keyword">UNIQUE</span> <span class="keyword">KEY</span> <span class="string">`idx_user_file`</span> (<span class="string">`user_name`</span>, <span class="string">`file_sha1`</span>),</span><br><span class="line">    <span class="keyword">KEY</span> <span class="string">`idx_status`</span> (<span class="string">`status`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>PRIMARY KEY(&lt;name&gt;)</code></li>
<li><code>UNIQUE KEY &lt;name&gt; (&lt;name1...&gt;)</code>表示name1…中所有字段是唯一的，命名为name<ul>
<li><code>INSERT IGNORE</code>时，要插入与unique相同的自动将会跳过</li>
</ul>
</li>
<li><code>KEY &lt;name&gt; (&lt;name&gt;)</code></li>
<li><code>SHOW CREATE TALBE &lt;table_name&gt;</code><ul>
<li>显示键表过程</li>
</ul>
</li>
</ul>
<h3 id="插入"><a href="#插入" class="headerlink" title="插入"></a>插入</h3><p><code>INSERT [INGORE] INTO &lt;表名&gt; &lt;字段名...&gt; VALUES &lt;字段对应值&gt;</code></p>
<ul>
<li><code>IGNORE</code>表示如果要插入的字段已存在，则忽略(不执行插入)</li>
</ul>
<h3 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h3><ul>
<li>软删除<code>DELETE</code></li>
<li>硬删除<code>DROP</code></li>
</ul>
<h3 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h3><h4 id="UPDATE语句"><a href="#UPDATE语句" class="headerlink" title="UPDATE语句"></a>UPDATE语句</h4><p><code>UPDATE &lt;table_name&gt; SET &lt;column&gt;=&lt;value&gt;... WHERE &lt;column&gt;=&lt;value&gt;</code></p>
<p> <strong>注意WHERE限定范围</strong> ，否则所有记录都将被更新</p>
<h4 id="REPALCE函数"><a href="#REPALCE函数" class="headerlink" title="REPALCE函数"></a>REPALCE函数</h4><ul>
<li>插入替换<ul>
<li>似乎如果碰到unique key就会替换</li>
<li><code>REPLACE INTO &lt;表名&gt; (&lt;字段...&gt;) VALUES &lt;新字段,...&gt;</code></li>
</ul>
</li>
<li>replace()函数<ul>
<li><code>REPALCE(&lt;object&gt;, &lt;search&gt;, &lt;replace&gt;)</code></li>
<li>将内容<code>&lt;object&gt;</code>中<code>&lt;search&gt;</code>到的替换为<code>&lt;repalce&gt;</code></li>
<li>实例<ul>
<li><code>SELECT REPLACE(&#39;http://&#39;,&#39;http&#39;,&#39;https&#39;)</code></li>
<li><code>UPDATE &lt;table_name&gt; SET name=replace(name,&#39;a&#39;,&#39;b&#39;)</code><ul>
<li>将表中name字段中所有a替换成b</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h3><p><code>SELECT &lt;字段...&gt; FROM [数据库].&lt;表&gt; [WHERE statement] [LIMIT statement]</code></p>
<h3 id="修改删除字段"><a href="#修改删除字段" class="headerlink" title="修改删除字段"></a>修改删除字段</h3><p><code>ALTER TABLE &lt;表名&gt; &lt;操作...&gt;</code>，如：</p>
<ul>
<li>新增, <code>ALTER TABLE &lt;表名&gt; ADD COlUMN &lt;字段名&gt; [定义...]</code></li>
<li>删除字段，<code>ALTER TABLE &lt;表名&gt; DROP &lt;字段名&gt;</code>，如：  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE tbl_user_file DROP INDEX &#96;idx_user_file&#96;;</span><br></pre></td></tr></table></figure></li>
<li>修改字段，<code>ALTER TABLE &lt;表名&gt; CHANGE &lt;旧字段名&gt; &lt;新字段名&gt; &lt;新数据类型&gt;;</code>  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tb_emp1 <span class="keyword">CHANGE</span> col1 col3 <span class="built_in">CHAR</span>(<span class="number">30</span>);</span><br></pre></td></tr></table></figure></li>
<li>修改字段类型，<code>ALTER TABLE &lt;表名&gt; MODIFY &lt;字段名&gt; &lt;数据类型&gt;</code></li>
</ul>
<h3 id="简单运算"><a href="#简单运算" class="headerlink" title="简单运算"></a>简单运算</h3><h4 id="求和"><a href="#求和" class="headerlink" title="求和"></a>求和</h4><ul>
<li><code>sum()</code>函数求和</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    <span class="keyword">sum</span>( &lt;fild_name&gt; [+ &lt;fild_name&gt;...] ) <span class="keyword">AS</span> &lt;<span class="keyword">alias</span>&gt;</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    &lt;<span class="keyword">table</span>&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>count()</code>计算总数，求平均</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">    <span class="keyword">sum</span>( &lt;fild_name&gt; [+ &lt;fild_name&gt;...] )/<span class="keyword">count</span>(*) <span class="keyword">AS</span> &lt;<span class="keyword">alias</span>&gt;</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    &lt;<span class="keyword">table</span>&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li><code>LIMIT &lt;range&gt;</code>限制范围<ul>
<li>如找前3行<code>... LIMIT 0,3</code></li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/10/03/universe/web/promise_async_and_wait/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Travis TuRing">
      <meta itemprop="description" content="Mens et Manus">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ring's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/10/03/universe/web/promise_async_and_wait/" class="post-title-link" itemprop="url">Promise, async和wait的简单记录</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-10-03 00:00:00 / Modified: 18:08:25" itemprop="dateCreated datePublished" datetime="2020-10-03T00:00:00+08:00">2020-10-03</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="为什么需要promise"><a href="#为什么需要promise" class="headerlink" title="为什么需要promise"></a>为什么需要promise</h2><p>有时候需要向函数中传入回调函数(异步操作结束后执行)，这么一来可能就会有多重函数嵌套的情况。这样的问题很明显：</p>
<ul>
<li>耦合度高</li>
<li>解耦要传函数指针<ul>
<li>安全考虑还需判断参数类型，可读性差</li>
<li>如果传送匿名参数，可读性更差</li>
</ul>
</li>
</ul>
<h2 id="Promise写法"><a href="#Promise写法" class="headerlink" title="Promise写法"></a>Promise写法</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">callRing</span>(<span class="params">success</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"calling Ring ..."</span>)</span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (success) &#123;</span><br><span class="line">                resolve()</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                reject()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;, <span class="number">3000</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line">callRing(<span class="literal">true</span>)</span><br><span class="line">    .then(<span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;) <span class="comment">// promise对象上的then方法。传入resolve函数</span></span><br><span class="line">    .catch(<span class="function"><span class="params">()</span>=&gt;</span>&#123;&#125;) <span class="comment">// promise对象上的catch方法。传入reject函数</span></span><br><span class="line">    <span class="comment">// 由于返回了promise对象，所以多次then调用是可行的</span></span><br></pre></td></tr></table></figure>

<ul>
<li><code>.then(function)</code>，传入promise对象的参数resolve和reject<ul>
<li>当然，可以传入两个参数，即第二个参数就是reject。用来指定reject回调</li>
</ul>
</li>
<li><code>.catch(function)</code><ul>
<li>它就是then的第二个参数</li>
<li>这么写能够处理执行resolve遇到异常的情况<ul>
<li>如果resolve执行时遇到异常，将会条到<code>.catch</code>中</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>Promise还有很多用法：all，race等</strong></p>
<h3 id="async、await"><a href="#async、await" class="headerlink" title="async、await"></a>async、await</h3><p>如果不喜欢.then这样的写法，可以使用async、await的写法</p>
<p>async的本质就是promise的语法糖，标记了async的function里面可以执行await的同步方法，await后的代码要等待await执行完成。</p>
<p>[猜]为什么promise能够做到同步呢？即.then().then()的同步原理</p>
<ul>
<li>当执行第一个promise时，是异步操作，最后才能返回promise。所以如果promise没返回就不会执行下一个</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// callRing函数不变</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 有await这个关键词的代码只能在一个async 定义的函数里执行</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">action</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="keyword">await</span> callRing(<span class="literal">true</span>) <span class="comment">// 如果是resolve则执行后续的代码</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"resolve"</span>)</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e)&#123;</span><br><span class="line">        <span class="comment">// 如果reject则执行catch的代码</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"resolve"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">action()</span><br></pre></td></tr></table></figure>

<p>或使用IIFE的写法，定义成匿名函数然后立即执行</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// callRing函数不变</span></span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        <span class="keyword">await</span> callRing(<span class="literal">true</span>) <span class="comment">// 如果是resolve则执行后续的代码</span></span><br><span class="line">        <span class="comment">// 否则抛出异常</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"resolve"</span>)</span><br><span class="line">    &#125; <span class="keyword">catch</span> (e)&#123;</span><br><span class="line">        <span class="comment">// 如果reject则执行catch的代码</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"resolve"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure>



      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/10/01/universe/operate/docker_base_usage/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Travis TuRing">
      <meta itemprop="description" content="Mens et Manus">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ring's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/10/01/universe/operate/docker_base_usage/" class="post-title-link" itemprop="url">Docker常用命令</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-10-01 00:00:00" itemprop="dateCreated datePublished" datetime="2020-10-01T00:00:00+08:00">2020-10-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-12-02 19:16:13" itemprop="dateModified" datetime="2020-12-02T19:16:13+08:00">2020-12-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Docker常用命令"><a href="#Docker常用命令" class="headerlink" title="Docker常用命令"></a>Docker常用命令</h2><ul>
<li><code>docker ps [-a]</code>，查看正在运行的[所有]容器</li>
<li><code>docker &lt;start|stop|rm&gt; &lt;ID|NAME&gt;</code>，启动/停止/删除容器<ul>
<li><code>docker rmi &lt;IMAGES&gt;</code>，删除镜像</li>
</ul>
</li>
<li><code>docker attach id</code>，进入某个容器，使用exit退出容器时，容器也会停止</li>
<li><code>docker exec -it &lt;ID|NAME&gt; &lt;/bin/bash&gt;</code>，启动一个shell，以交互形式进入容器，exit时容器不停止</li>
<li><code>docker run --name NEWNAME -it CONTAINER [/bin/bash]</code><ul>
<li>复制CONTAINER容器，并重命名为NEWNAME，[使用bash以交互模式进入]</li>
</ul>
</li>
<li><code>docker inspect &lt;CONTAINER&gt;</code>查看详情</li>
</ul>
<h2 id="基本操作"><a href="#基本操作" class="headerlink" title="基本操作"></a>基本操作</h2><h3 id="配置容器"><a href="#配置容器" class="headerlink" title="配置容器"></a>配置容器</h3><ul>
<li><ol>
<li>交互式编辑<ul>
<li><code>docker run -it &lt;ID|NAME&gt; &lt;/bin/bash&gt;</code>，交互式进入，安装编辑器编辑对应的配置文件<ul>
<li>见<code>man docker &lt;COMMAND&gt;</code></li>
<li><code>-i</code>表示启动一个可以交互的容器</li>
<li><code>-t</code>表示分配一个pseudo-tty</li>
<li><code>-d|--detach</code>表示后台启动一个容器</li>
<li><code>-a|--attach</code>进入一个已经启动的容器<ul>
<li>使用<code>c-p c-q</code>退出容器时保持运行</li>
</ul>
</li>
</ul>
</li>
<li>在一个TCP端口上绑定一个服务<ul>
<li><code>-p ip:[hostPort]:containerPort | [hostPort:]containerPort</code></li>
<li><code>-P</code>暴露容器所有端口到宿主机上的一个随机端口，如<code>0.0.0.0:32768-&gt;33060</code></li>
</ul>
</li>
<li>安装ssh服务后，使用ssh进入编辑<ul>
<li><ol>
<li><code>apt-get install openssh-server</code></li>
</ol>
</li>
<li><ol start="2">
<li>修改配置文件，”PermitRootLogin without-password”去掉注释免密登录</li>
</ol>
</li>
<li><ol start="3">
<li><code>service ssh start</code></li>
</ol>
</li>
</ul>
</li>
</ul>
</li>
</ol>
</li>
<li><ol start="2">
<li><code>docker cp &lt;CONTAINER:/path/to/conf&gt; &lt;/source/file&gt;</code></li>
</ol>
</li>
<li><ol start="3">
<li>保存容器为镜像<ul>
<li><code>docker commit &lt;ID|NAME&gt; &lt;NEW_IMG&gt;</code><ul>
<li>通过名字或id保存一个容器为镜像</li>
</ul>
</li>
<li>将镜像保存为<code>.tar</code>文件<ul>
<li><code>docker save &lt;NAME&gt; &gt; &lt;tar&gt;</code></li>
<li>使用重定向符保存</li>
</ul>
</li>
<li>使用<code>load</code>从<code>.tar</code>文件加载镜像<ul>
<li><code>docker load &lt; &lt;.tar&gt;</code></li>
<li>输入如保存对称</li>
</ul>
</li>
</ul>
</li>
</ol>
</li>
</ul>
<h3 id="管理容器"><a href="#管理容器" class="headerlink" title="管理容器"></a>管理容器</h3><h4 id="管理容器数据"><a href="#管理容器数据" class="headerlink" title="管理容器数据"></a>管理容器数据</h4><p>使用数据卷(volume)，用于持久化共享数据</p>
<ul>
<li><code>-v[=[[HOST-DIR:]CONTAINER-DIR[:OPTIONS]]]</code><ul>
<li>将外部的目录/文件映射到docker内部</li>
<li>可以挂载多个数据卷</li>
<li>挂载主机目录或文件作为数据卷的话必须使用绝对路径</li>
<li>OPTION可以设置权限，ro只读</li>
</ul>
</li>
<li>创建和挂载数据卷容器：有一些数据可能需要在容器间共享，故创建数据卷容器是个不错的选择<ul>
<li>使用<code>--volumes-from &lt;CONTAINER&gt;</code>来挂载其他容器中的数据卷<ul>
<li>可以挂载多个，只要是挂载了数据卷的容器就行</li>
</ul>
</li>
</ul>
</li>
<li>删除容器数据卷并不会删除。删除最后一个还挂载它的容器时使用<code>docker rm -v</code>来同时删除</li>
</ul>
<h4 id="管理容器通信"><a href="#管理容器通信" class="headerlink" title="管理容器通信"></a>管理容器通信</h4><ul>
<li>使用端口映射的方式通信<ul>
<li>顾名思义</li>
</ul>
</li>
<li>使用link方式通信，<ul>
<li>links允许容器发现另一个容器，并在期间建立一个安全的通信以便交换数据， <strong>不会暴露任何端口</strong> </li>
<li><code>--link &lt;name|id&gt;[:alias]</code></li>
<li>一个连接允许源容器提供信息给目标容器，如数据库</li>
</ul>
</li>
</ul>
<p>TODO move to advanced</p>
<h5 id="Link的原理"><a href="#Link的原理" class="headerlink" title="Link的原理"></a>Link的原理</h5><p>环境变量</p>
<h2 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h2><p>Dockerfile是docker镜像的配置文件</p>
<h3 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h3><ul>
<li>FROM<ul>
<li><code>FROM &lt;image&gt;</code></li>
<li>指定基于哪个镜像</li>
</ul>
</li>
<li>RUN<ul>
<li>shell形式：<code>RUN &lt;cmd&gt;</code></li>
<li>exec形式：<code>RUN [&quot;exec&quot;, &quot;arg1&quot;, &quot;arg2&quot;]</code></li>
<li>执行命令，<strong>在docker build时运行</strong></li>
</ul>
</li>
<li>COPY<ul>
<li><code>COPY [--chown=&lt;user&gt;:&lt;group&gt;] &lt;src&gt;... &lt;dst&gt;</code><ul>
<li>同样源和目的也可使用exec形式传递</li>
</ul>
</li>
<li>将文件或目录复制到容器中的指定目录</li>
</ul>
</li>
<li>CMD<ul>
<li>类似RUN，但运行的时间点不同</li>
<li>在docker run时运行</li>
<li><strong>指定启动容器时默认要运行的程序</strong></li>
<li>CMD指令可以被docker run中exec指定的程序覆盖</li>
<li>Dockerfile中有多个CMD，只有最后一个生效</li>
</ul>
</li>
<li>ENTRYPOINT<ul>
<li>类似CMD，但不会被dockr run中的命令行参数指定的指令覆盖，这些命令行参数会被当作参数传递给ENTRYPOINT指定的程序<ul>
<li>一般通过CMD传入变参，然ENTRYPOINT执行，如  <figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ENTRYPOINT</span><span class="bash"> [<span class="string">"nginx"</span>, <span class="string">"-c"</span>]  <span class="comment"># 定参</span></span></span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> [<span class="string">"/etc/nginx/nginx.conf"</span>] <span class="comment"># 变参  </span></span></span><br><span class="line"><span class="comment"># 这么就实现了不传参执行默认参数，传参覆盖参数执行</span></span><br></pre></td></tr></table></figure></li>
<li>可以使用<code>--entrypoint</code>参数覆盖</li>
</ul>
</li>
<li>Dockerfile中有多个ENTRYPOINT，只有最后一个生效</li>
</ul>
</li>
<li>ENV<ul>
<li><code>ENV &lt;key&gt; &lt;value&gt;</code>或<code>ENV &lt;key1&gt;=&lt;value1&gt; &lt;key2&gt;=&lt;value2&gt;</code></li>
<li>设置环境变量，以在后序指令中使用<code>$&lt;key&gt;</code></li>
</ul>
</li>
<li>ARG<ul>
<li><code>ARG &lt;arg&gt;[=&lt;default&gt;]</code></li>
<li>构造参数，作用同ENV，但作用域不同<ul>
<li>ARG仅在Dockerfile中有效(即build中)</li>
<li>可以使用<code>docker build --build-arg</code>覆盖，可以起到构建时传参的效果</li>
</ul>
</li>
</ul>
</li>
<li>VOLUME<ul>
<li><code>VOLUME [&quot;dir1&quot;, &quot;dir2&quot;...]</code>或<code>VOLUME &lt;dir&gt;</code></li>
<li>定义匿名数据卷。如果启动容器时忘记挂载数据卷，就挂载到匿名数据卷<ul>
<li>避免数据丢失</li>
<li>避免容器不断变大</li>
</ul>
</li>
</ul>
</li>
<li>EXPOSE<ul>
<li><code>EXPOSE &lt;port1&gt; [&lt;port2&gt;...]</code></li>
<li>声明(暴露)端口。运行使用随机端口映射时，即<code>docker run -P</code>，会自动随机映射EXPOSE的端口</li>
</ul>
</li>
<li>WORKDIR<ul>
<li><code>WORKDIR &lt;dir&gt;</code></li>
<li>指定运行时的主目录<ul>
<li>没有时自动创建</li>
</ul>
</li>
</ul>
</li>
<li>USER<ul>
<li><code>USER &lt;user&gt;[:&lt;group&gt;]</code></li>
<li>指定运行使用的用户和用户组</li>
</ul>
</li>
<li>ONBUILD<ul>
<li>当前镜像构建时不执行，当当前进行作为其他镜像构建时才执行</li>
</ul>
</li>
<li>LABEL<ul>
<li><code>LABEL [&lt;key&gt;=&lt;value&gt;...]</code></li>
<li>为docker镜像设置些标签，起区分作用，用<code>docker inspect</code>查看</li>
</ul>
</li>
</ul>
<h3 id="构建镜像"><a href="#构建镜像" class="headerlink" title="构建镜像"></a>构建镜像</h3><ul>
<li><code>docker build -t &lt;image&gt;[:version]</code><ul>
<li><code>--build-arg</code>指定构造参数</li>
</ul>
</li>
</ul>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><ul>
<li>STOPSIGNAL用于指定容器退出的信号</li>
<li>HEALTHCHECK用于指定容器健康检查的配置</li>
<li>SHELL用于指定脚本如windows镜像需要指定CMD /S /C</li>
</ul>
<h2 id="Play-With-Dockerhub"><a href="#Play-With-Dockerhub" class="headerlink" title="Play With Dockerhub"></a>Play With Dockerhub</h2><ul>
<li>创建一个帐号</li>
<li>新建一个仓库</li>
<li>登录<ul>
<li><code>docker login</code></li>
</ul>
</li>
<li>将容器/镜像保存为与仓库对应的镜像<ul>
<li>如<code>66ring/centos:tagname</code></li>
</ul>
</li>
<li>推到hub<ul>
<li><code>docker push 66ring/centos:tagname</code></li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Travis TuRing</p>
  <div class="site-description" itemprop="description">Mens et Manus</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">81</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">67</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Travis TuRing</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  

</body>
</html>
