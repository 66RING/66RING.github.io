<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Mens et Manus">
<meta property="og:type" content="website">
<meta property="og:title" content="Ring&#39;s Blog">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="Ring&#39;s Blog">
<meta property="og:description" content="Mens et Manus">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Travis TuRing">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/page/2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Ring's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Ring's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/10/01/universe/docker_base_usage/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Travis TuRing">
      <meta itemprop="description" content="Mens et Manus">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ring's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/10/01/universe/docker_base_usage/" class="post-title-link" itemprop="url">Docker常用命令</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-10-01 00:00:00" itemprop="dateCreated datePublished" datetime="2020-10-01T00:00:00+08:00">2020-10-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-11-19 14:09:12" itemprop="dateModified" datetime="2020-11-19T14:09:12+08:00">2020-11-19</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Docker常用命令"><a href="#Docker常用命令" class="headerlink" title="Docker常用命令"></a>Docker常用命令</h2><ul>
<li><code>docker ps [-a]</code>，查看正在运行的[所有]容器</li>
<li><code>docker &lt;start|stop|rm&gt; &lt;ID|NAME&gt;</code>，启动/停止/删除容器<ul>
<li><code>docker rmi &lt;IMAGES&gt;</code>，删除镜像</li>
</ul>
</li>
<li><code>docker attach id</code>，进入某个容器，使用exit退出容器时，容器也会停止</li>
<li><code>docker exec -it &lt;ID|NAME&gt; &lt;/bin/bash&gt;</code>，启动一个shell，以交互形式进入容器，exit时容器不停止</li>
<li><code>docker run --name NEWNAME -it CONTAINER [/bin/bash]</code><ul>
<li>复制CONTAINER容器，并重命名为NEWNAME，[使用bash以交互模式进入]</li>
</ul>
</li>
<li><code>docker inspect &lt;CONTAINER&gt;</code>查看详情</li>
</ul>
<h2 id="基本操作"><a href="#基本操作" class="headerlink" title="基本操作"></a>基本操作</h2><h3 id="配置容器"><a href="#配置容器" class="headerlink" title="配置容器"></a>配置容器</h3><ul>
<li><ol>
<li>交互式编辑<ul>
<li><code>docker run -it &lt;ID|NAME&gt; &lt;/bin/bash&gt;</code>，交互式进入，安装编辑器编辑对应的配置文件<ul>
<li>见<code>man docker &lt;COMMAND&gt;</code></li>
<li><code>-i</code>表示启动一个可以交互的容器</li>
<li><code>-t</code>表示分配一个pseudo-tty</li>
<li><code>-d</code>(detach)表示后台启动</li>
</ul>
</li>
<li>在一个TCP端口上绑定一个服务<ul>
<li><code>-p ip:[hostPort]:containerPort | [hostPort:]containerPort</code></li>
<li><code>-P</code>暴露容器所有端口到宿主机上的一个随机端口，如<code>0.0.0.0:32768-&gt;33060</code></li>
</ul>
</li>
<li>安装ssh服务后，使用ssh进入编辑<ul>
<li><ol>
<li><code>apt-get install openssh-server</code></li>
</ol>
</li>
<li><ol start="2">
<li>修改配置文件，”PermitRootLogin without-password”去掉注释免密登录</li>
</ol>
</li>
<li><ol start="3">
<li><code>service ssh start</code></li>
</ol>
</li>
</ul>
</li>
</ul>
</li>
</ol>
</li>
<li><ol start="2">
<li><code>docker cp &lt;CONTAINER:/path/to/conf&gt; &lt;/source/file&gt;</code></li>
</ol>
</li>
<li><ol start="3">
<li>保存镜像<ul>
<li><code>docker commit &lt;ID|NAME&gt; &lt;NEW_IMG&gt;</code><ul>
<li>通过名字或id保存一个容器为镜像</li>
</ul>
</li>
<li>将镜像保存为<code>.tar</code>文件<ul>
<li><code>docker save &lt;NAME&gt; &gt; &lt;tar&gt;</code></li>
<li>使用重定向符保存</li>
</ul>
</li>
<li>使用<code>load</code>从<code>.tar</code>文件加载镜像<ul>
<li><code>docker load &lt; &lt;.tar&gt;</code></li>
<li>输入如保存对称</li>
</ul>
</li>
</ul>
</li>
</ol>
</li>
</ul>
<h3 id="管理容器"><a href="#管理容器" class="headerlink" title="管理容器"></a>管理容器</h3><h4 id="管理容器数据"><a href="#管理容器数据" class="headerlink" title="管理容器数据"></a>管理容器数据</h4><p>使用数据卷(volume)，用于持久化共享数据</p>
<ul>
<li><code>-v[=[[HOST-DIR:]CONTAINER-DIR[:OPTIONS]]]</code><ul>
<li>将外部的目录/文件映射到docker内部</li>
<li>可以挂载多个数据卷</li>
<li>挂载主机目录或文件作为数据卷的话必须使用绝对路径</li>
<li>OPTION可以设置权限，ro只读</li>
</ul>
</li>
<li>创建和挂载数据卷容器：有一些数据可能需要在容器间共享，故创建数据卷容器是个不错的选择<ul>
<li>使用<code>--volumes-from &lt;CONTAINER&gt;</code>来挂载其他容器中的数据卷<ul>
<li>可以挂载多个，只要是挂载了数据卷的容器就行</li>
</ul>
</li>
</ul>
</li>
<li>删除容器数据卷并不会删除。删除最后一个还挂载它的容器时使用<code>docker rm -v</code>来同时删除</li>
</ul>
<h4 id="管理容器通信"><a href="#管理容器通信" class="headerlink" title="管理容器通信"></a>管理容器通信</h4><ul>
<li>使用端口映射的方式通信<ul>
<li>顾名思义</li>
</ul>
</li>
<li>使用link方式通信，<ul>
<li>links允许容器发现另一个容器，并在期间建立一个安全的通信以便交换数据， <strong>不会暴露任何端口</strong> </li>
<li><code>--link &lt;name|id&gt;[:alias]</code></li>
<li>一个连接允许源容器提供信息给目标容器，如数据库</li>
</ul>
</li>
</ul>
<h5 id="Link的原理"><a href="#Link的原理" class="headerlink" title="Link的原理"></a>Link的原理</h5><p>环境变量</p>
<h2 id="Dockerfile"><a href="#Dockerfile" class="headerlink" title="Dockerfile"></a>Dockerfile</h2><h3 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h3><ul>
<li>FROM<ul>
<li><code>FROM &lt;image&gt;</code></li>
<li>指定基于哪个镜像</li>
</ul>
</li>
<li>RUN<ul>
<li>shell形式：<code>RUN &lt;cmd&gt;</code></li>
<li>exec形式：<code>RUN [&quot;exec&quot;, &quot;arg1&quot;, &quot;arg2&quot;]</code></li>
<li>执行命令，<strong>在docker build时运行</strong></li>
</ul>
</li>
<li>COPY<ul>
<li><code>COPY [--chown=&lt;user&gt;:&lt;group&gt;] &lt;src&gt;... &lt;dst&gt;</code><ul>
<li>同样源和目的也可使用exec形式传递</li>
</ul>
</li>
<li>将文件或目录复制到容器中的指定目录</li>
</ul>
</li>
<li>CMD<ul>
<li>类似RUN，但运行的时间点不同</li>
<li>在docker run时运行</li>
<li><strong>指定启动容器时默认要运行的程序</strong></li>
<li>CMD指令可以被docker run中exec指定的程序覆盖</li>
<li>Dockerfile中有多个CMD，只有最后一个生效</li>
</ul>
</li>
<li>ENTRYPOINT<ul>
<li>类似CMD，但不会被dockr run中的命令行参数指定的指令覆盖，这些命令行参数会被当作参数传递给ENTRYPOINT指定的程序<ul>
<li>一般通过CMD传入变参，然ENTRYPOINT执行，如  <figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ENTRYPOINT</span><span class="bash"> [<span class="string">"nginx"</span>, <span class="string">"-c"</span>]  <span class="comment"># 定参</span></span></span><br><span class="line"><span class="keyword">CMD</span><span class="bash"> [<span class="string">"/etc/nginx/nginx.conf"</span>] <span class="comment"># 变参  </span></span></span><br><span class="line"><span class="comment"># 这么就实现了不传参执行默认参数，传参覆盖参数执行</span></span><br></pre></td></tr></table></figure></li>
<li>可以使用<code>--entrypoint</code>参数覆盖</li>
</ul>
</li>
<li>Dockerfile中有多个ENTRYPOINT，只有最后一个生效</li>
</ul>
</li>
<li>ENV<ul>
<li><code>ENV &lt;key&gt; &lt;value&gt;</code>或<code>ENV &lt;key1&gt;=&lt;value1&gt; &lt;key2&gt;=&lt;value2&gt;</code></li>
<li>设置环境变量，以在后序指令中使用<code>$&lt;key&gt;</code></li>
</ul>
</li>
<li>ARG<ul>
<li><code>ARG &lt;arg&gt;[=&lt;default&gt;]</code></li>
<li>构造参数，作用同ENV，但作用域不同<ul>
<li>ARG仅在Dockerfile中有效(即build中)</li>
<li>可以使用<code>docker build --build-arg</code>覆盖</li>
</ul>
</li>
</ul>
</li>
<li>VOLUME<ul>
<li><code>VOLUME [&quot;dir1&quot;, &quot;dir2&quot;...]</code>或<code>VOLUME &lt;dir&gt;</code></li>
<li>定义匿名数据卷。如果启动容器时忘记挂载数据卷，就挂载到匿名数据卷<ul>
<li>避免数据丢失</li>
<li>避免容器不断变大</li>
</ul>
</li>
</ul>
</li>
<li>EXPOSE<ul>
<li><code>EXPOSE &lt;port1&gt; [&lt;port2&gt;...]</code></li>
<li>声明(暴露)端口。运行使用随机端口映射时，即<code>docker run -P</code>，会自动随机映射EXPOSE的端口</li>
</ul>
</li>
<li>WORKDIR<ul>
<li><code>WORKDIR &lt;dir&gt;</code></li>
<li>指定运行时的主目录</li>
</ul>
</li>
<li>USER<ul>
<li><code>USER &lt;user&gt;[:&lt;group&gt;]</code></li>
<li>指定运行使用的用户和用户组</li>
</ul>
</li>
<li>ONBUILD<ul>
<li>当前镜像构建时不执行，当当前进行作为其他镜像构建时才执行</li>
</ul>
</li>
</ul>
<h3 id="构建镜像"><a href="#构建镜像" class="headerlink" title="构建镜像"></a>构建镜像</h3><ul>
<li><code>docker build -t &lt;image&gt;[:version]</code><ul>
<li><code>--build-arg</code>指定构造参数</li>
</ul>
</li>
</ul>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><ul>
<li>STOPSIGNAL用于指定容器退出的信号</li>
<li>HEALTHCHECK用于指定容器健康检查的配置</li>
<li>SHELL用于指定脚本如windows镜像需要指定CMD /S /C</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/16/universe/vim/advanced_vim_programming/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Travis TuRing">
      <meta itemprop="description" content="Mens et Manus">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ring's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/16/universe/vim/advanced_vim_programming/" class="post-title-link" itemprop="url">Advanced Vim Programming</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-09-16 00:00:00" itemprop="dateCreated datePublished" datetime="2020-09-16T00:00:00+08:00">2020-09-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-25 09:49:30" itemprop="dateModified" datetime="2020-10-25T09:49:30+08:00">2020-10-25</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="lt-SID-gt"><a href="#lt-SID-gt" class="headerlink" title="&lt;SID&gt;"></a>&lt;SID&gt;</h2><blockquote>
<p>The string <code>&lt;SID&gt;</code> can be used in a mapping or menu.</p>
<p>When executing the map command, Vim will replace <code>&lt;SID&gt;</code> with the special key code <code>&lt;SNR&gt;</code>, followed by a number that’s unique for the script, and an underscore.  Example: <code>:map &lt;SID&gt;Add</code> could define a mapping <code>&lt;SNR&gt;23\_Add</code>.</p>
</blockquote>
<p>When you map some thing to a <code>s:</code> function, which means you may call it may mapping outside of the script. Try the follow scirpts:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">function! s:say()</span><br><span class="line">    echo expand(&quot;&lt;SID&gt;&quot;)</span><br><span class="line">    echo &quot;hello&quot;</span><br><span class="line">endfunction</span><br><span class="line">map WW :call s:say()&lt;CR&gt;</span><br><span class="line">map RR :call &lt;SID&gt;say()&lt;CR&gt;</span><br></pre></td></tr></table></figure>

<p>When mapping <code>WW</code> is executed from outside of scirpt, it don’t know which the script the function was defined.</p>
<p>The <code>:scriptnames</code> command can be used to see which scripts have been sourced</p>
<h3 id="lt-sfile-gt"><a href="#lt-sfile-gt" class="headerlink" title="&lt;sfile&gt;"></a>&lt;sfile&gt;</h3><p><code>:h &lt;sfile&gt;</code></p>
<h2 id="lt-Plug-gt"><a href="#lt-Plug-gt" class="headerlink" title="&lt;Plug&gt;"></a>&lt;Plug&gt;</h2><blockquote>
<p>The special key name <code>&lt;Plug&gt;</code> can be used for an internal mapping, which is not to be matched with any key sequence.  This is useful in plugins</p>
</blockquote>
<p>As the doc file said, <code>&lt;Plug&gt;</code> key is often use in a internal mapping. Like:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">func! s:somecme</span><br><span class="line">    ...</span><br><span class="line">endfunc</span><br><span class="line">noremap &lt;silent&gt; &lt;Plug&gt;SomeCmd :call &lt;SID&gt;somecmd</span><br><span class="line">nmap ss &lt;Plug&gt;SomeCmd</span><br></pre></td></tr></table></figure>

<ul>
<li>Why Vim has this feature?<ul>
<li>may be its a way to set alias in vimscript?</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/03/universe/RPC/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Travis TuRing">
      <meta itemprop="description" content="Mens et Manus">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ring's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/03/universe/RPC/" class="post-title-link" itemprop="url">RPC intro</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-09-03 00:00:00" itemprop="dateCreated datePublished" datetime="2020-09-03T00:00:00+08:00">2020-09-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-02 22:02:57" itemprop="dateModified" datetime="2020-10-02T22:02:57+08:00">2020-10-02</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="RPC-Remote-Procedure-Call"><a href="#RPC-Remote-Procedure-Call" class="headerlink" title="RPC (Remote Procedure Call)"></a>RPC (Remote Procedure Call)</h2><p>RPC，远程过程调用，是一个计算机通信协议。</p>
<p>相对的就是本地过程调用，即一个程序中调用它的子程序，可以直接通过地址访问。而RPC的远程，就是跨进程访问的意思。</p>
<p>该协议允许运行于一台计算机的程序调用另一个地址空间(通常是开放网络中的一台计算机)的子程序。程序员就像调用本地程序一样，无需额外地为这个交互作用编程。</p>
<p>RPC是一种Client/Server的进程间通信模式，程序分布在不同的地址空间里。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Client          Server</span><br><span class="line">    |               ^</span><br><span class="line">    v               |</span><br><span class="line">proxy           proxy       动态代理层</span><br><span class="line">    |               |</span><br><span class="line">protocol        protocol    序列化&#x2F;反序列化层</span><br><span class="line">    |               | </span><br><span class="line">network   ---&gt;  network     网络传输层</span><br></pre></td></tr></table></figure>



<h2 id="Go语言RPC实例"><a href="#Go语言RPC实例" class="headerlink" title="Go语言RPC实例"></a>Go语言RPC实例</h2><h3 id="入门"><a href="#入门" class="headerlink" title="入门"></a>入门</h3><p>GO语言的RPC包路径为<code>net/rpc</code></p>
<ul>
<li>一个对象要能走RPC调用需要规则<ul>
<li>Go语言的RPC规则：公开方法只能有两个可序列化的参数，第二个参数为指针类型，并返回一个error</li>
</ul>
</li>
<li>注册RPC服务<code>rpc.RegisterName(&quot;NameSpace&quot;, new(对象))</code><ul>
<li>会将对象类型中所有满足RPC规则的对象方法注册为RPC函数</li>
<li>所有注册的方法会放在”NameSpace”的命名空间下</li>
</ul>
</li>
<li>拨号RPC服务<code>client, err := rpc.Dial(&quot;tcp&quot;, &quot;localhost:1234&quot;)</code><ul>
<li>这里建立通过tcp调用本机1234端口的rpc服务的连接</li>
</ul>
</li>
<li>调用RPC服务<code>client.Call(&quot;NameSpace.Func&quot;, &quot;arg1&quot;, &amp;args)</code><ul>
<li>第一个参数用点连接RPC服务的名字和要调用的方法</li>
<li>第二、三个参数，是RPC需要的两个参数</li>
</ul>
</li>
<li><strong>安全的RPC调用</strong> <ul>
<li>上面就实现的简单的RPC调用过程，但是在<strong>RPC方法名，参数类型等还存在安全隐患</strong>。所以更安全的RPC调用需要进行一些简单的封装<ul>
<li>如：  <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *RPCServerClien)</span> <span class="title">SomeFunc</span><span class="params">(request <span class="keyword">string</span>, reply *<span class="keyword">string</span>)</span> <span class="title">error</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> p.Client.Call(<span class="string">"NameSpace.SomeFunc"</span>, request, reply)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



</li>
</ul>
</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/08/20/universe/js_ts/this_and_arrow_function/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Travis TuRing">
      <meta itemprop="description" content="Mens et Manus">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ring's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/20/universe/js_ts/this_and_arrow_function/" class="post-title-link" itemprop="url">This和箭头函数</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-08-20 00:00:00 / Modified: 16:24:00" itemprop="dateCreated datePublished" datetime="2020-08-20T00:00:00+08:00">2020-08-20</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="This"><a href="#This" class="headerlink" title="This"></a>This</h2><p><strong>This用于访问当前方法所属的对象</strong>，取决于调用的对象如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    a: <span class="number">12</span>,</span><br><span class="line">    fn()&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 或者形如</span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    a: <span class="number">12</span>,</span><br><span class="line">&#125;</span><br><span class="line">obj.fn = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">obj.fn()  <span class="comment">// 将打印obj这个对象</span></span><br></pre></td></tr></table></figure>

<p>上面的例子中，<code>fn()</code>输入obj，所以this就是obj</p>
<h3 id="调用工具函数来改变this"><a href="#调用工具函数来改变this" class="headerlink" title="调用工具函数来改变this"></a>调用工具函数来改变this</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">show()&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>当直接调用<code>show()</code>时，严格模式下this是undefine</li>
<li>使用<code>call</code>强制改变<code>this</code><ul>
<li><code>show.call(obj)</code>，那么this就等于obj</li>
<li>与call类似的还有<code>bind</code>，<code>apply</code>等<ul>
<li><code>f=show.bind(obj)</code>指定this为obj并返回一个函数</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="箭头函数"><a href="#箭头函数" class="headerlink" title="箭头函数"></a>箭头函数</h2><p>普通函数中，this取决于调用;在箭头函数中，this取决于定义。定义箭头函数时，箭头函数中的this取决于当前环境的this，如：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="keyword">this</span>)  <span class="comment">// &#123;&#125;</span></span><br><span class="line"><span class="keyword">const</span> fn=<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>)</span><br><span class="line">&#125;</span><br><span class="line">fn()  <span class="comment">// &#123;&#125;</span></span><br><span class="line"><span class="comment">// 甚至call也改变不了</span></span><br><span class="line">fn.call(<span class="number">12</span>)  <span class="comment">// &#123;&#125;</span></span><br></pre></td></tr></table></figure>


<h3 id="应用举例"><a href="#应用举例" class="headerlink" title="应用举例"></a>应用举例</h3><p>如在react中想要点击按钮给数字加1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; WRONG</span><br><span class="line">&lt;button onClick&#x3D;&#123;function()&#123;</span><br><span class="line">    this.setState(&#123;a: this.state.a+1&#125;)</span><br><span class="line">&#125;&#125;&gt;按钮&lt;&#x2F;button&gt;</span><br><span class="line">&#x2F;&#x2F; WRONG 此时传入普通函数相当于直接调用，那么this就是undefine</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; CORRECT</span><br><span class="line">&lt;button onClick&#x3D;&#123;()&#x3D;&gt;&#123;</span><br><span class="line">    this.setState(&#123;a: this.state.a+1&#125;)</span><br><span class="line">&#125;&#125;&gt;按钮&lt;&#x2F;button&gt;</span><br><span class="line">&#x2F;&#x2F; CORRECT 此时传入箭头函数，this取决于当前环境，即React.Component这个class中</span><br></pre></td></tr></table></figure>



      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/08/17/universe/go/golang_mem_alignment/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Travis TuRing">
      <meta itemprop="description" content="Mens et Manus">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ring's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/17/universe/go/golang_mem_alignment/" class="post-title-link" itemprop="url">Golang内存对齐</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-08-17 00:00:00 / Modified: 13:58:15" itemprop="dateCreated datePublished" datetime="2020-08-17T00:00:00+08:00">2020-08-17</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="Golang内存对齐"><a href="#Golang内存对齐" class="headerlink" title="Golang内存对齐"></a><center>Golang内存对齐<center></h2><p>Cpu要想读取数据，需要通过 <strong>地址总线</strong> 把地址传输给内存。内存准备好数据输出到 <strong>数据总线</strong> ，交给CPU。</p>
<p>每根地址总线能表示一位，8根地址总线就能表示8位二进制数，即256个地址。因为表示不了更大的地址，所以就用不了更大的内存。</p>
<p>每次操作一字节太慢，那就加宽数据总线，要想一次操作一字节就至少需要32位数据总线。8字节就64位。这里每次操作的字节数就是所谓的  <strong>机器字长</strong> 。</p>
<p>从内存读取数据时通过”并行”操作同时从储存单元(DRAM芯片)读出数据。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">----+-------+-------+-------+---- address</span><br><span class="line">    |       |       |       |</span><br><span class="line">    |       |       |       |</span><br><span class="line">  chip1    chip2   chip3    chip4</span><br><span class="line">    |       |       |       |</span><br><span class="line">    0       0       1       1</span><br><span class="line">----</span><br><span class="line">0011...</span><br><span class="line">假设有8个chip</span><br></pre></td></tr></table></figure>

<p>每个储存单元共用同一个地址，各自从地址取出一位组成我们逻辑上认为的连续4字节数据。提高了内存访问效率。</p>
<p>采用着用设计，那么<code>address</code>就必须的8的倍数。如果非要错开一个格，那么错开后多出来的格子和其他不同，不能在一次操作中被同一个地址选中，所以这样的地址是不能用的。</p>
<p>CPU对这种情况的处理：多次读取。如取第一次读取的后7字节和第二次读取的前1字节拼接得到想要的8字节数据。但这样就影响了性能。</p>
<p>为了保证程序顺利高效的运行，编译器会把各种类型的数据安排到合适的地址并占用合适的长度，这就叫做 <strong>内存对齐</strong>。每种类型对齐值就是它的 <strong>对齐边界</strong>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">| 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 |</span><br><span class="line">|---|---|---|---|---|---|---|---|</span><br><span class="line">用0~1存储int16的数据，对齐值(对齐边界)就是2</span><br><span class="line">用4~7存储int32的数据，对齐边界就是4</span><br></pre></td></tr></table></figure>

<p>内存对齐要求数据存储地址以及占用的字节数都是它对齐边界的倍数。因此，在上面的情况中，如果int16从0开始(0%2=0;2%2=0)，那么int32就要错开两字节，从4开始(4%4=0;4%4=0)。</p>
<h3 id="如何确定每种类型的对齐边界"><a href="#如何确定每种类型的对齐边界" class="headerlink" title="如何确定每种类型的对齐边界"></a>如何确定每种类型的对齐边界</h3><p>这与平台有关，go支持很多平台386、arm、mips等。常见的32位平台指针宽度和寄存器宽度都是4字节，64位平台上都是8字节。被Go语言称为寄存器宽度的这个值就可以理解为机器字长，也是平台对应的最大对齐边界。</p>
<p>数据对齐边界取数据类型大小和平台最大对齐边界中较小的一个。如果只根据平台最大对齐边界对齐，则容易浪费很多字节(跳过很多空闲的字节)。</p>
<h3 id="结构体的对齐边界"><a href="#结构体的对齐边界" class="headerlink" title="结构体的对齐边界"></a>结构体的对齐边界</h3><p>取结构体中数据类型大小最大的成员，这个就是这个结构体的对齐边界。</p>
<ul>
<li><ol>
<li>存储这个结构体的起始地址是对齐边界的倍数</li>
</ol>
</li>
<li><ol start="2">
<li>结构体每个成员存储时，都把起始地址当作地址0，然后再用相对地址决定自己放在哪</li>
</ol>
</li>
<li><ol start="3">
<li>结构体整体占用字节数需要是类型对齐边界的倍数，不够的话往后扩张</li>
</ol>
</li>
</ul>
<p>例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">type T struct&#123;</span><br><span class="line">    a int8   &#x2F;&#x2F; 1byte</span><br><span class="line">    b int64  &#x2F;&#x2F; 8byte</span><br><span class="line">    c int32  &#x2F;&#x2F; 4byte</span><br><span class="line">    d int16  &#x2F;&#x2F; 2byte</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">最大是8，所以改结构体对齐边界是8</span><br><span class="line"></span><br><span class="line">第一个成员a从0开始;第二个成员要对齐，只能从8开始;第三个成员从16开始，占用16~19;第四个成员从20开始占用20~21。然后还需要向后扩张到23</span><br></pre></td></tr></table></figure>

<p>思考：调整结构体成员的顺序是否能够优化内存？</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/08/11/universe/go/gui_programming/gui_programming/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Travis TuRing">
      <meta itemprop="description" content="Mens et Manus">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ring's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/11/universe/go/gui_programming/gui_programming/" class="post-title-link" itemprop="url">Golang gui 编程笔记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-08-11 00:00:00" itemprop="dateCreated datePublished" datetime="2020-08-11T00:00:00+08:00">2020-08-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-12 20:49:00" itemprop="dateModified" datetime="2020-08-12T20:49:00+08:00">2020-08-12</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="基本结构"><a href="#基本结构" class="headerlink" title="基本结构"></a>基本结构</h2><ul>
<li>初始化</li>
<li>用户设置<ul>
<li><ol>
<li>创建主窗口<ul>
<li><code>win := gtk.NewWindow(gtk.WINDOW_TOPLEVEL)</code></li>
</ul>
</li>
</ol>
</li>
<li><ol start="2">
<li>设置窗口属性<ul>
<li><code>win.SetTitle(&quot;gtk go&quot;)</code></li>
<li><code>win.SetSizeRequest(400, 320)</code></li>
</ul>
</li>
</ol>
</li>
<li><ol start="3">
<li>创建容器控件(固定布局、任意布局)<ul>
<li><code>layout := gtk.NewFixed()</code></li>
</ul>
</li>
</ol>
</li>
<li><ol start="4">
<li>布局添加到窗口上<ul>
<li><code>win.Add(layout)</code></li>
</ul>
</li>
</ol>
</li>
<li><ol start="5">
<li>显示控件<ul>
<li><code>win.ShowAll()</code>，否则一个一个show</li>
</ul>
</li>
</ol>
</li>
</ul>
</li>
<li>主事件循环</li>
</ul>
<h3 id="控件"><a href="#控件" class="headerlink" title="控件"></a>控件</h3><p>控件包含：属性、方法</p>
<h3 id="信号处理"><a href="#信号处理" class="headerlink" title="信号处理"></a>信号处理</h3><p>形如</p>
<ul>
<li>注册按钮处理点击事件<ul>
<li><code>b1.Connect(&quot;clicked&quot;, handlefunc, args)</code></li>
<li>也可以使用封装好的<code>b.Clicked(func(){})</code></li>
<li><code>handlefunc(ctx *glib.CallbackContext)</code>进行处理，接受args参数<ul>
<li>也可使用匿名函数</li>
</ul>
</li>
<li>使用<code>ctx.Data()</code>获取传入的参数。返回空接口类型，可以使用断言<ul>
<li><code>data, ok := ctx.Data().(string)</code>，如果是string类型则<code>if ok通过</code></li>
</ul>
</li>
</ul>
</li>
<li>关闭窗口触发destroy<ul>
<li><code>win.Connect(&quot;destroy&quot;, func(){gtk.MainQuit()}, args)</code></li>
</ul>
</li>
</ul>
<h2 id="使用glade辅助"><a href="#使用glade辅助" class="headerlink" title="使用glade辅助"></a>使用glade辅助</h2><ul>
<li>编辑好后加载glade文件：<ul>
<li><code>builder := gtk.NewBuilder()</code></li>
<li><code>builder.AddFromFile(&quot;xxx.glade&quot;)</code></li>
</ul>
</li>
<li>获取glade上的控件<ul>
<li><code>win := gtk.WindowFromObject(builder.GetObject(&quot;yourObjName&quot;))</code>，获取窗口</li>
<li>显示控件，如果是glade添加的控件，<code>show</code>即可显示所有<ul>
<li><code>win.Show()</code></li>
</ul>
</li>
<li>信号处理的方法页一样</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/08/09/universe/tech_tips/CAS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Travis TuRing">
      <meta itemprop="description" content="Mens et Manus">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ring's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/09/universe/tech_tips/CAS/" class="post-title-link" itemprop="url">CAS简记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-08-09 00:00:00" itemprop="dateCreated datePublished" datetime="2020-08-09T00:00:00+08:00">2020-08-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-19 20:26:49" itemprop="dateModified" datetime="2020-10-19T20:26:49+08:00">2020-10-19</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="CAS-Compare-And-Swap"><a href="#CAS-Compare-And-Swap" class="headerlink" title="CAS(Compare And Swap)"></a>CAS(Compare And Swap)</h2><p>CAS是一种乐观锁。何谓悲观，编译器认为就是如果不严格同步线程调用则一定会产生异常，所以悲观锁会阻塞其他所有线程调用(互斥)。</p>
<p>但是并不是所有操作都一定会产生异常，如多线程的读操作就不会。</p>
<h3 id="CAS机制"><a href="#CAS机制" class="headerlink" title="CAS机制"></a>CAS机制</h3><p>在多线程对共享资源访问时比较共享资源当前的状态(newValue)和发起调用时的状态(oldValue)。如果状态一样则还没其他线程访问，这个线程(swap)改变共享资源的状态并访问，结束后再换会原来的状态；如果状态不一样则说明已被其他线程占用，进入自旋等待时机尝试再次访问。</p>
<p>为了保证比较过程是安全的，CAS的compare操作必须的原子操作，所以开销是比切换到内核态调用mutex再切换会用户态是小很多的。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/08/08/universe/web/jwt/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Travis TuRing">
      <meta itemprop="description" content="Mens et Manus">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ring's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/08/universe/web/jwt/" class="post-title-link" itemprop="url">jwt原理</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-08-08 00:00:00" itemprop="dateCreated datePublished" datetime="2020-08-08T00:00:00+08:00">2020-08-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-10 19:21:50" itemprop="dateModified" datetime="2020-08-10T19:21:50+08:00">2020-08-10</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="传统的基于token的用户验证"><a href="#传统的基于token的用户验证" class="headerlink" title="传统的基于token的用户验证"></a>传统的基于token的用户验证</h2><ul>
<li><ol>
<li>用户登录<ul>
<li>服务返回token，并在服务端保存token</li>
</ul>
</li>
</ol>
</li>
<li><ol start="2">
<li>用户验证<ul>
<li>用户再次访问时需要携带token，比较数据库中的token</li>
</ul>
</li>
</ol>
</li>
</ul>
<h2 id="Json-Web-Token"><a href="#Json-Web-Token" class="headerlink" title="Json Web Token"></a>Json Web Token</h2><ul>
<li><ol>
<li>用户登录<ul>
<li>服务返回token，但不保存token</li>
</ul>
</li>
</ol>
</li>
<li><ol start="2">
<li>用户验证<ul>
<li>用户再次访问时需要携带token，再做token校验</li>
</ul>
</li>
</ol>
</li>
</ul>
<h3 id="jwt实现过程"><a href="#jwt实现过程" class="headerlink" title="jwt实现过程"></a>jwt实现过程</h3><ul>
<li><ol>
<li>用户提交用户名和密码，如果登录成功，使用jwt创建一个token并给用户返回<ul>
<li>jwt生成的token由三段字符串生成，并由<code>.</code>连接<ul>
<li>第一段字符串：HEADER。内部包含算法和token类型，json转换成字符串然后做base64url加密<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"alg"</span>: <span class="string">"HS256"</span>,</span><br><span class="line">    <span class="attr">"typ"</span>: <span class="string">"JWT"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>第二段字符串：PAYLOAD。内容自定义值，但一般都有<code>exp</code>超时时间，且不包含敏感信息<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"id"</span>: <span class="string">"123"</span>,</span><br><span class="line">    <span class="attr">"name"</span>: <span class="string">"ring"</span>,</span><br><span class="line">    "exp"  0000000000,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>第三段字符串。第一和第二部分的密文拼接，然后加密。加密方式由第一段字符串给出， <strong>并且<code>加盐</code></strong> 。在这次加密后(HS256，第一次加密不能反解)再对密文进行base64url加密</li>
</ul>
</li>
</ul>
</li>
</ol>
</li>
<li><ol start="2">
<li>校验token<ul>
<li><ol>
<li>对token进行切割，<code>.</code></li>
</ol>
</li>
<li><ol start="2">
<li>对第二段进行base64url解密，获取PAYLOAD信息。然后检测超时时间</li>
</ol>
</li>
<li><ol start="3">
<li>把第一第二段拼接进行HS256解密(第一段指定的加密方式)加密。让密文和第三段base64url解密后的密文比较</li>
</ol>
</li>
</ul>
</li>
</ol>
</li>
<li>能防止篡改吗？<ul>
<li>由于第三段密文是<code>加盐</code>后加密得到的，而盐只有自己知道，所以不能篡改</li>
</ul>
</li>
</ul>
<h3 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h3><p>官网给出了对很多语言、算法的支持</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/08/06/universe/config_lang/yaml_basic/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Travis TuRing">
      <meta itemprop="description" content="Mens et Manus">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ring's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/08/06/universe/config_lang/yaml_basic/" class="post-title-link" itemprop="url">Yaml Basic</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-08-06 00:00:00 / Modified: 20:29:53" itemprop="dateCreated datePublished" datetime="2020-08-06T00:00:00+08:00">2020-08-06</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><a href="https://yaml.org/spec/1.2/spec.html" target="_blank" rel="noopener">Offical Tutorial</a></p>
<h2 id="Basic"><a href="#Basic" class="headerlink" title="Basic"></a>Basic</h2><p><code>key: value</code></p>
<p>Yaml will auto detect data type, but some time that’s what we don’t want. So you need  <strong>Type cast</strong> :</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">age:</span> <span class="type">!!str</span> <span class="number">10</span></span><br></pre></td></tr></table></figure>

<ul>
<li>type avaliable<ul>
<li>str</li>
<li>int</li>
<li>float</li>
<li>bool</li>
<li>null</li>
<li>ISO date type:<code>2020-1-1 11:11:22</code></li>
<li>array</li>
</ul>
</li>
</ul>
<h2 id="Array"><a href="#Array" class="headerlink" title="Array"></a>Array</h2><p><strong>Can not use TAB</strong> in yaml. Use indentation to grading and <code>-</code> char to sign as a array.</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">arr:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">item1</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">item11</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">item2</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">item21</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">item22</span></span><br></pre></td></tr></table></figure>


<h2 id="Object"><a href="#Object" class="headerlink" title="Object"></a>Object</h2><p><strong>Can not use TAB</strong> in yaml. Use indentation to grading but no <code>-</code> char.</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">person:</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">ring</span></span><br><span class="line">  <span class="attr">age:</span> <span class="number">10</span></span><br></pre></td></tr></table></figure>


<h2 id="Long-string-value"><a href="#Long-string-value" class="headerlink" title="Long string value"></a>Long string value</h2><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">message:</span></span><br><span class="line">  <span class="string">a</span> <span class="string">long</span> <span class="string">long</span> <span class="string">long</span></span><br><span class="line">  <span class="string">long</span> <span class="string">long</span></span><br><span class="line">  <span class="string">long</span> <span class="string">msg</span></span><br></pre></td></tr></table></figure>

<p>To end with <code>\n</code> </p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">message:</span> <span class="string">&gt;</span></span><br><span class="line">  <span class="string">a</span> <span class="string">long</span> <span class="string">long</span> <span class="string">long</span></span><br><span class="line">  <span class="string">long</span> <span class="string">long</span></span><br><span class="line">  <span class="string">long</span> <span class="string">msg</span></span><br></pre></td></tr></table></figure>

<p>To end with <code>\n</code> for each line </p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">message:</span> <span class="string">|</span></span><br><span class="line">  <span class="string">a</span> <span class="string">long</span> <span class="string">long</span> <span class="string">long</span></span><br><span class="line">  <span class="string">long</span> <span class="string">long</span></span><br><span class="line">  <span class="string">long</span> <span class="string">msg</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">#a long long long\nlong long\nlong msg\n</span></span><br></pre></td></tr></table></figure>


<h2 id="Use-Reference"><a href="#Use-Reference" class="headerlink" title="Use Reference"></a>Use Reference</h2><p>Assign with pointer</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">father:</span> <span class="meta">&amp;father_info</span></span><br><span class="line">  <span class="attr">name:</span> <span class="string">ring</span></span><br><span class="line"></span><br><span class="line"><span class="attr">monitor:</span> <span class="meta">*father_info</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># value of monitor same as value of father</span></span><br></pre></td></tr></table></figure>


<h2 id="New-part"><a href="#New-part" class="headerlink" title="New part"></a>New part</h2><p>Yaml not allow you have dulplicate key. You can use <code>---</code> to statement in a new part</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">ring</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">ring</span></span><br></pre></td></tr></table></figure>


<h2 id="End-of-File"><a href="#End-of-File" class="headerlink" title="End of File"></a>End of File</h2><p>You can use <code>...</code> to tell yaml, this is the end.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/07/24/universe/web/react_note/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Travis TuRing">
      <meta itemprop="description" content="Mens et Manus">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ring's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/07/24/universe/web/react_note/" class="post-title-link" itemprop="url">React学习笔记</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-07-24 00:00:00" itemprop="dateCreated datePublished" datetime="2020-07-24T00:00:00+08:00">2020-07-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-08-13 11:04:15" itemprop="dateModified" datetime="2020-08-13T11:04:15+08:00">2020-08-13</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>React是用于构建用户界面的javascript库</p>
<ul>
<li>特性<ul>
<li>声明式编程<ul>
<li>通过代码告诉计算机，你想的是什么，让计算机想出如何去做</li>
<li>命令式编程：告诉计算机去做什么</li>
</ul>
</li>
<li>组件化</li>
<li>一次学会，随处编写</li>
</ul>
</li>
</ul>
<h2 id="Main-Concepts"><a href="#Main-Concepts" class="headerlink" title="Main Concepts"></a>Main Concepts</h2><h3 id="Rendering-Elements"><a href="#Rendering-Elements" class="headerlink" title="Rendering Elements"></a>Rendering Elements</h3><p>To rendering an element into a root DOM node like <code>&lt;div id=&quot;root&quot;&gt;&lt;/div&gt;</code>, pass both to <code>ReactDOM.render()</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> element = <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, world<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">ReactDOM.render(element, <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>));</span><br></pre></td></tr></table></figure>

<p>React elements are immutable. Once you create an element, you can’t change its children or attributes. React Only Updates What’s Necessary.</p>
<p>With our knowledge so far, the only way to update the UI is to create a new element, and pass it to <code>ReactDOM.render()</code>.</p>
<h3 id="Components-and-Props"><a href="#Components-and-Props" class="headerlink" title="Components and Props"></a>Components and Props</h3><p>Components are like JavaScript functions. <strong>They accept arbitrary inputs (called “props”) and return React elements</strong>.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Welcome</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, &#123;props.name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>This function is valid React component because it accept a single “props” object and return a React element.</p>
<p>You can also use an <code>ES6 class</code> to define a component:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Welcome</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, &#123;this.props.name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h4 id="Rendering-a-Component"><a href="#Rendering-a-Component" class="headerlink" title="Rendering a Component"></a>Rendering a Component</h4><p>React element not only can represent DOM tags, but also can represent user-defined components.</p>
<p><strong>When React sees an element representing a user-defined component, it pass JSX attributes and children to this component as a single object</strong>. We call this obj “props”.</p>
<p>For example:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Welcome</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, &#123;props.name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> element = <span class="xml"><span class="tag">&lt;<span class="name">Welcome</span> <span class="attr">name</span>=<span class="string">"Sara"</span> /&gt;</span></span>;</span><br><span class="line">ReactDOM.render(</span><br><span class="line">  element,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>


<h4 id="Props-are-Read-Only"><a href="#Props-are-Read-Only" class="headerlink" title="Props are Read-Only"></a>Props are Read-Only</h4><p>React is pretty flexible but it has a single strict rule:</p>
<p><strong>All React components must act like pure functions with respect to their props</strong></p>
<h3 id="State-and-Lifecycle"><a href="#State-and-Lifecycle" class="headerlink" title="State and Lifecycle"></a>State and Lifecycle</h3><p>State is similar to props, but it it private and fully controlled by the component.</p>
<ul>
<li>Converting a Function to a Class<ul>
<li><ol>
<li>Create an <code>ES6 class</code>, with the same name, that extends <code>React.Component</code></li>
</ol>
</li>
<li><ol start="2">
<li>Add a single empty method to it called <code>render()</code></li>
</ol>
</li>
<li><ol start="3">
<li>Move the body of the function into the <code>render()</code> method</li>
</ol>
</li>
<li><ol start="4">
<li>Replace <code>props</code> with <code>this.props</code> in the <code>render()</code> body</li>
</ol>
</li>
<li><ol start="5">
<li>Delete the remaining empty function declaration</li>
</ol>
</li>
</ul>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Clock</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;Hello, world!&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">        &lt;h2&gt;It is &#123;this.props.date.toLocaleTimeString()&#125;.&lt;/</span>h2&gt;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>


<h4 id="Adding-Local-State-to-a-Class"><a href="#Adding-Local-State-to-a-Class" class="headerlink" title="Adding Local State to a Class"></a>Adding Local State to a Class</h4><ul>
<li><ol>
<li>Add a <code>class constructor</code> that assigns the initial <code>this.state</code><ul>
<li>Class components should always call the base constructor with <code>props</code><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123;<span class="attr">date</span>: <span class="keyword">new</span> <span class="built_in">Date</span>()&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
</li>
<li><ol start="2">
<li>Replace <code>this.props.date</code> with <code>this.state.date</code></li>
</ol>
</li>
</ul>
<h4 id="Adding-Lifecycle-Methods-to-a-Class"><a href="#Adding-Lifecycle-Methods-to-a-Class" class="headerlink" title="Adding Lifecycle Methods to a Class"></a>Adding Lifecycle Methods to a Class</h4><p>We can declare special methods on the component class to run some code when a component mounts and unmounts:</p>
<ul>
<li><code>componentDidMount()</code> method runs after the component output has been rendered to the DOM</li>
<li><code>componentWillUnmount()</code></li>
<li>Use <code>this.setState()</code> to schedule updates to the component local state:<ul>
<li>like: <code>this.setState({date: new Date()})</code></li>
</ul>
</li>
</ul>
<h4 id="Using-State-Correctly"><a href="#Using-State-Correctly" class="headerlink" title="Using State Correctly"></a>Using State Correctly</h4><ul>
<li><strong>Do Not Modify State Directly</strong> <ul>
<li>WRONG: <code>this.state.comment = &quot;hello&quot;</code></li>
<li>CORRECT: <code>this.setState({comment: &quot;hello&quot;})</code></li>
<li>the only place where you can assign <code>this.state</code> is the constructor</li>
</ul>
</li>
<li><strong>State Updates May Be Asynchronous</strong><ul>
<li>React may batch multiple <code>setState()</code> calls into a single update for performance</li>
<li>Because of that, you should not rely on their values for calculating the next state</li>
<li><strong>To fix it, use a second form of <code>setState()</code> that accepts a function rather than an object</strong><ul>
<li>the function will receive the previous state as the first argument, and the props as the time update is applied as the second argument</li>
<li><code>this.setState((state, props)=&gt;{})</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="State-Updates-are-Merged"><a href="#State-Updates-are-Merged" class="headerlink" title="State Updates are Merged"></a>State Updates are Merged</h4><p><a href="https://reactjs.org/docs/state-and-lifecycle.html#state-updates-are-merged" target="_blank" rel="noopener">???</a></p>
<h4 id="The-Date-Flows-Down"><a href="#The-Date-Flows-Down" class="headerlink" title="The Date Flows Down"></a>The Date Flows Down</h4><p>Both parent and children should not care if a certain component is stateful(class) or stateless(functionf). It is not accessible to any component other than the one that owns and sets it.</p>
<p>A component may choose to pass its state down as props to its child components: <code>&lt;FormattedDate date={this.state.date} /&gt;</code></p>
<p>This is commonly called a “top-down” or “unidirectional” data flow.</p>
<h3 id="Handling-Events"><a href="#Handling-Events" class="headerlink" title="Handling Events"></a>Handling Events</h3><p>With JSX you pass a function as the handler, rather than string.</p>
<p>the Html:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">"activateLasers()"</span>&gt;</span></span><br><span class="line">  Activate Lasers</span><br><span class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>it is different in React</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;button onClick=&#123;activateLasers&#125;&gt;</span><br><span class="line">  Activate Lasers</span><br><span class="line">&lt;<span class="regexp">/button&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ActionLink</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">handleClick</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">    e.preventDefault();</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'The link was clicked.'</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;a href=<span class="string">"#"</span> onClick=&#123;handleClick&#125;&gt;</span><br><span class="line">      Click me</span><br><span class="line">    &lt;<span class="regexp">/a&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ Or</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">class Click extends React.Component&#123;</span></span><br><span class="line"><span class="regexp">  function handleClick(e) &#123;</span></span><br><span class="line"><span class="regexp">    e.preventDefault();</span></span><br><span class="line"><span class="regexp">    console.log('The link was clicked.');</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  render()&#123;</span></span><br><span class="line"><span class="regexp">    return (</span></span><br><span class="line"><span class="regexp">      &lt;a href="#" onClick=&#123;this.handleClick&#125;&gt;</span></span><br><span class="line"><span class="regexp">        Click me</span></span><br><span class="line"><span class="regexp">      &lt;/</span>a&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Here, <code>e</code> is a synthetic event. See the <a href="https://reactjs.org/docs/events.html" target="_blank" rel="noopener">SyntheticEvent</a> reference guide to learn more.</p>
<p>In JavaScript, class methods are not <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_objects/Function/bind" target="_blank" rel="noopener">bound</a> by defaul.</p>
<p>Generally, if you refer to a method without <code>()</code> after it, such as <code>onClick={this.handleClick}</code>, you should bind that method. <a href="https://www.smashingmagazine.com/2014/01/understanding-javascript-function-prototype-bind/" target="_blank" rel="noopener">how funcions work in JavaScript</a>.</p>
<h3 id="Conditional-Rendering"><a href="#Conditional-Rendering" class="headerlink" title="Conditional Rendering"></a>Conditional Rendering</h3><p>Use JavaScript operators like <code>if</code> or <code>conditonal operator</code> to Conditional Rendering.</p>
<h3 id="Lists-and-Keys"><a href="#Lists-and-Keys" class="headerlink" title="Lists and Keys"></a>Lists and Keys</h3><h4 id="Lists"><a href="#Lists" class="headerlink" title="Lists"></a>Lists</h4><p>You can use <code>map()</code> to create <code>listItems</code> in React:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line"><span class="keyword">const</span> listItems = numbers.map(<span class="function">(<span class="params">number</span>) =&gt;</span></span><br><span class="line">  &lt;li&gt;&#123;number&#125;&lt;<span class="regexp">/li&gt;</span></span><br><span class="line"><span class="regexp">);</span></span><br></pre></td></tr></table></figure>

<p>When you render them, you’ll be given a warning that a key should be provided for list items.</p>
<h4 id="Keys"><a href="#Keys" class="headerlink" title="Keys"></a>Keys</h4><p>Keys help React identify which items have changed, are added, or are removed. Keys should be given to the elements inside the array to give the elements a stable identity.</p>
<p>If you choose not to assign an explicit key to list items then React will default to using indexes as keys.</p>
<h4 id="Extracting-Components-with-Keys"><a href="#Extracting-Components-with-Keys" class="headerlink" title="Extracting Components with Keys"></a>Extracting Components with Keys</h4><p>Keys only make sense in the context of the surrounding array.</p>
<p>If you extract a ListItem components, you should keep the key on the <code>&lt;ListItem /&gt;</code> element, but not inside.</p>
<h3 id="Forms"><a href="#Forms" class="headerlink" title="Forms"></a>Forms</h3><h4 id="Controlled-Components"><a href="#Controlled-Components" class="headerlink" title="Controlled Components"></a>Controlled Components</h4><p>An input form element whose value is controlled by React in this way is called a “controlled component”.</p>
<p>With a controlled component, the input’s value is always driven by the React state. For example:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NameForm</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123;<span class="attr">value</span>: <span class="string">''</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.handleChange = <span class="keyword">this</span>.handleChange.bind(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">this</span>.handleSubmit = <span class="keyword">this</span>.handleSubmit.bind(<span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handleChange(event) &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;<span class="attr">value</span>: event.target.value&#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handleSubmit(event) &#123;</span><br><span class="line">    alert(<span class="string">'A name was submitted: '</span> + <span class="keyword">this</span>.state.value);</span><br><span class="line">    event.preventDefault();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;form onSubmit=&#123;<span class="keyword">this</span>.handleSubmit&#125;&gt;</span><br><span class="line">        &lt;label&gt;</span><br><span class="line">          Name:</span><br><span class="line">          &lt;input type=<span class="string">"text"</span> value=&#123;<span class="keyword">this</span>.state.value&#125; onChange=&#123;<span class="keyword">this</span>.handleChange&#125; /&gt;</span><br><span class="line">        &lt;<span class="regexp">/label&gt;</span></span><br><span class="line"><span class="regexp">        &lt;input type="submit" value="Submit" /</span>&gt;</span><br><span class="line">      &lt;<span class="regexp">/form&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>set <code>value</code> attribute<ul>
<li>the displayed value will always be <code>this.state.value</code></li>
</ul>
</li>
<li><code>handleChange</code> <ul>
<li>runs on every keystroke to update the React state, the displayed value will update as the user types</li>
</ul>
</li>
</ul>
<h3 id="Composition-vs-Inheritance"><a href="#Composition-vs-Inheritance" class="headerlink" title="Composition vs Inheritance"></a>Composition vs Inheritance</h3><h4 id="Containment"><a href="#Containment" class="headerlink" title="Containment"></a>Containment</h4><p>Some component don’t know their children ahead of time. We recommend that such component use the special <code>children</code> prop to pass children elements directly into their output.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">E</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &#123;props.children&#125;</span><br><span class="line">        &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">function Hello()&#123;</span></span><br><span class="line"><span class="regexp">    return (</span></span><br><span class="line"><span class="regexp">        &lt;E&gt;</span></span><br><span class="line"><span class="regexp">            &lt;h1&gt;hello&lt;/</span>h1&gt;</span><br><span class="line">        &lt;<span class="regexp">/E&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>

<p>Anything inside the <code>&lt;E&gt;</code> tag gets passed into the <code>E</code> component as <code>props.children</code>.</p>
<p>Some time you might need multiple “holes” in a componnet. You can:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">E</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">            &lt;div&gt;&#123;props.left&#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">            &lt;div&gt;&#123;props.right&#125;&lt;/</span>div&gt;</span><br><span class="line">        &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">function Hello()&#123;</span></span><br><span class="line"><span class="regexp">    return (</span></span><br><span class="line"><span class="regexp">        &lt;E</span></span><br><span class="line"><span class="regexp">          left=&#123;</span></span><br><span class="line"><span class="regexp">              &lt;h1&gt;hello&lt;/</span>h1&gt;</span><br><span class="line">          &#125;</span><br><span class="line">          right=&#123;</span><br><span class="line">              &lt;h1&gt;world&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">          &#125; /</span>&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="Advanced"><a href="#Advanced" class="headerlink" title="Advanced"></a>Advanced</h2><p><a href="https://reactjs.org/docs/accessibility.html" target="_blank" rel="noopener">https://reactjs.org/docs/accessibility.html</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Travis TuRing</p>
  <div class="site-description" itemprop="description">Mens et Manus</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">69</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">61</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Travis TuRing</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  

</body>
</html>
